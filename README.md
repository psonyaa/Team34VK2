# ***Team34VK2***

# Предсказание количества просмотров рекламы

## Описание проекта
Проект направлен на **прогнозирование количества просмотров рекламы** в социальной сети Вконтакте с использованием методов анализа данных и машинного обучения. 

## Цель проекта 
Обучение модели, способной прогнозировать количествор пользователей, которые увидят конкретное рекламное объявление в будущем, основываясь на данных о предыдущих показах.

## Используемые данные
В проекте используются следующие наборы данных, которые хранятся в формате TSV:

1. **Данные по пользователям (`users.tsv`)**:
   - `user_id`: Уникальный идентификатор пользователя.
   - `sex`: Пол пользователя, указанный в анкете.
   - `age`: Возраст пользователя, указанный в анкете (0 — не указан).
   - `city_id`: Город проживания пользователя (0 — не указан).
   <p>Этот файл содержит информацию о пользователях, что позволяет анализировать их демографические характеристики и выявлять закономерности в поведении.

2. **Данные показов рекламы (`history.tsv`)**:
   - `hour`: Час, в который пользователь увидел объявление.
   - `cpm`: Цена показанного рекламного объявления в рекламном аукционе (максимальная ставка).
   - `publisher`: Площадка, на которой пользователь увидел рекламу.
   - `user_id`: Уникальный идентификатор пользователя.
   <p>Данный файл фиксирует историю показов рекламы пользователям за два последовательных месяца, что позволяет анализировать активность и предпочтения аудитории.

3. **Данные для валидации (`validate.tsv`)**:
   - `cpm`: Цена объявления, для которой необходимо сделать прогноз.
   - `hour_start`: Предполагаемое время запуска рекламного объявления.
   - `hour_end`: Предполагаемое время остановки рекламного объявления. Прогноз делается для объявлений, которые будут запущены в период времени `[hour_start, hour_end]`.
   - `publishers`: Площадки, на которых может быть показано объявление.
   - `audience_size`: Размер аудитории объявления (количество идентификаторов в поле `user_ids`).
   - `user_ids`: Список пользователей, которым рекламодатель хочет показать объявление.
   <p>Этот файл используется для тестирования алгоритма и оценки его производительности.

4. **Эталонные ответы для валидации (`validate_answers.tsv`)**:
   - `at_least_one`: Доля пользователей, которые увидят объявление хотя бы один раз.
   - `at_least_two`: Доля пользователей, которые увидят объявление хотя бы два раза.
   - `at_least_three`: Доля пользователей, которые увидят объявление хотя бы три раза.
   <p>Эталонные ответы необходимы для проверки точности предсказаний модели и оценки ее эффективности.

## Метрика оценки задачи и дополнительные условия
Задача оценивается по метрике, которая учитывает значения из всех трех колонок: `at_least_one`, `at_least_two` и `at_least_three`.

### Smoothed Mean Log Accuracy Ratio
Метрика определяется как **Smoothed Mean Log Accuracy Ratio**, переведенная в проценты. Формула для расчета метрики выглядит следующим образом:

<img width="650" alt="Снимок экрана 2024-12-13 в 13 24 00" src="https://github.com/user-attachments/assets/c8a0904f-a233-4d3a-9720-8d6c6ca3826a" />

#### Где:
- **n** — количество предсказаний.
- **Predicted_i** — предсказанное значение для \( i \)-го наблюдения.
- **Actual_i** — эталонное значение для \( i \)-го наблюдения.
- **ε = 0.005** — коэффициент сглаживания.

### Интерпретация метрики
Метрика интерпретируется как среднее значение относительного расхождения между эталонными и предсказанными значениями в процентах. 
<p>Например: Значение 30% означает, что в среднем модель ошибается на 30% от реального значения.
<p>Чем ближе метрика к 0, тем лучше качество предсказаний модели.

<p>Экспоненциальная функция в формуле используется для вычисления экспоненты от среднего логарифмического относительного расхождения, что позволяет учитывать как переоценку (overpredict), так и недооценку (underpredict) предсказаний.

### Важные условия работы аукциона и условности задачи
Для корректного понимания модели важно учитывать следующие условия работы аукциона:
- Если ставка объявления `cpm` больше всех ставок остальных участников, то с **100% вероятностью** выигрывает объявление со ставкой `cpm`.
- Если ставка объявления `cpm` равна максимальной ставке среди всех остальных участников, то объявление со ставкой `cpm` выигрывает с **50% вероятностью**. В реальном аукционе правила могут отличаться, но это упрощение используется для моделирования в данном датасете.
- Система запоминает все объявления, которые видел пользователь в течение сессии, и не показывает их повторно, даже если они являются самыми дорогими в аукционе. Новая сессия начинается после отсутствия показов рекламы пользователю в течение **6 часов**.

## Описание всех работ
<p>Выполненные задачи в рамках EDA:
  
- Проверка на дубликаты и пропуски в данных
- Удаление дубликатов
- Визуализация распределения признаков
- Обнаружение и удаление выбросов
- Анализ категориальных признаков
- Создание новых признаков
- Корреляционный анализ
  
<p>Выполненные задачи в рамках разработки ML моделей:
  
- Разработка PU классификатора
- Эксперименты с гиперпараметрами
- Создание модели для предсказания вероятности класса
- Оптимизация гиперпараметров различных моделей
- Сравнительный анализ моделей по целевой метрике
- Составление результирующего пайплайна

## Как пользоваться проектом
- здесь допишем как пользоваться тем, что мы сделаем :)


## Участники команды и их роли
- **Софья Пашкевич - Тимлид**: Координирует работу команды, управляет проектом и поддерживает связь с заказчиком.
  
- **Артём Урсеков - Аналитик данных**: Проводит первичный анализ и очистку данных, формирует итоговый датасет.

- **Артур Нурмухаметов - Аналитик данных**: Занимается фиче-инженирингом и созданием новых признаков для улучшения модели.

- **Тимур Глазков - ML-инженер**: Экспериментирует с моделями, оптимизирует гиперпараметры и составляет результирующий пайплайн.

- **Андрей Халов - ML-инженер**: Выбирает и обучает наилучшую модель, подбирает гиперпараметры и анализирует её производительность.

- **Алексей Фомин - Технический писатель**: Создает документацию проекта и инструкции по использованию.
